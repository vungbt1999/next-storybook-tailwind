import { SEOData } from '@/components/common';
import { ImageObj, LinkObj } from '@/types';
import { ImageFragment, LinkFragment, SeoFragment } from '@/utils/graphql-api/generated';

const fallbackImage =
  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB04AAATfCAMAAACyOiRZAAAB71BMVEXm6ezk5+vl6Ovh5OjO09i/xsyzu8OosbqirLWeqLKbpa+cpq+gqbOkrbattb65wMfFy9HX29/e4ubDyc+qsru0u8PP1NnU2N2wuMChq7Tg4+fV2d+ttL29xMvi5ujg5Oi4v8ejrLbM0tfY3eDO1NnBx86krrfZ3eG2vsXT2NzAx82hqrPc4OTN0tinsLni5unX3OCxucG/xczU2d2qs7ymr7iwt7/L0dbR19zj5umdp7Gnsbmutr+iq7XIztTl6Ozd4eW2vcavt8DQ1dqfqLOyusK4v8ba3eKcprCnsLiwuL/W2uCep7HIzdPf4+bh5ei1vMTK0Na8w8nR1tvDys/a3+K5wcjGzNLM0de7wsni5enb3+O0vMOpsbqosbnCyM++xMynr7mlrre8w8rY3eHW2t/O09nj5urc3+TR1tyut7+psbu2vcW6wcnS19u7wsittb2rtLzk5+qstL3e4uWzu8KjrLXZ3eKvt7/L0Na3vsbb4OO3vsXHzdLJz9Xj5+rd4OS8wsmttr6psrrCyc+rtLu8xMrT19zJz9Ta3uLa3uOzusK1vcWvuL+msLmqtLyxuMCfqbLK0NXEytDS1tydp7DFytHGzNO6wMigqrPP09nV2t6fqLKeqLHFzNLAxc2xucCkrLakrbe1vcTn6u0fXcL7AAAApXRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////6oWeITyAAAQ0ElEQVR4AezahZEDQQwAMIcTh57hnpmx/+JSxq1npDoUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADA/8Rf24NjAQAAAARg/h6BBtHZNgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4FpGAEABiha/oqqmosQAAAAASUVORK5CYII=';

export const transformImageObj = (imageObj?: ImageFragment) => {
  const imageObjData: ImageObj = {
    url: fallbackImage,
    alternativeText: 'Meta-DOS',
    formats: null
  };

  if (imageObj) {
    const image = imageObj.data;
    if (image && image.attributes) {
      const imageAttributes = image.attributes;
      imageObjData.url = imageAttributes.url;
      imageObjData.alternativeText = imageAttributes.alternativeText || 'meta-dos';
      imageObjData.formats = imageAttributes.formats;
      imageObjData.mime = imageAttributes.mime;
      imageObjData.height = imageAttributes.height || null;
      imageObjData.width = imageAttributes.width || null;
    }
  }

  return imageObjData;
};

export const transformLink = (raw?: LinkFragment): LinkObj => {
  const link: LinkObj = {
    id: '',
    title: '',
    url: '',
    target: '_parent'
  };

  if (raw) {
    link.id = raw.id;
    link.title = raw.title;
    link.url = raw.url;
    link.target = raw.target ? (`_${raw.target}` as LinkObj['target']) : '_self';
  }
  return link;
};

export const transformSEO = (raw?: SeoFragment | null, siteName = 'Dos Chain'): SEOData | null => {
  if (raw) {
    return {
      siteName,
      title: raw?.metaTitle,
      description: raw?.metaDescription,
      image: transformImageObj(raw?.metaImage),
      keywords: raw?.keywords || '',
      robots: raw?.metaRobots || '',
      viewport: raw?.metaViewport || '',
      canonicalUrl: raw?.canonicalURL || ''
    };
  }
  return null;
};
